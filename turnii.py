import pulp

persone = ['x', 'bi', 'ugo', 'albo', 'lollo', 'chiara', 'selenia', 'pancotto', 'giacomino', 'eugenietto', 'ermenegildo', 'francescopio', 'gianmichelino', 'francescomario', 'annamariateresa', 'elkammmmmmmmoide']

ore = ['1h', '2h', '3h', '4h', '5h', '6h', '7h', '8h', '9h', '10h', '11h', '12h', '13h', '14h', '15h', '16h', '17h', '18h', '19h', '20h', '21h', '22h', '23h', '24h', '25h', '26h', '27h', '28h', '29h', '30h', '31h', '32h', '33h', '34h', '35h', '36h', '37h', '38h', '39h', '40h', '41h', '42h', '43h', '44h', '45h', '46h', '47h', '48h', '49h', '50h', '51h', '52h', '53h', '54h', '55h', '56h', '57h', '58h', '59h', '60h', '61h', '62h', '63h', '64h', '65h', '66h', '67h', '68h', '69h', '70h', '71h', '72h', '73h', '74h']


hMax = {'x': 1, 'bi': 3, 'ugo': 6, 'albo': 6, 'lollo': 6, 'chiara': 6, 'selenia': 6, 'pancotto': 6, 'giacomino': 6, 'eugenietto': 6, 'ermenegildo': 2, 'francescopio': 6, 'gianmichelino': 6, 'francescomario': 5, 'annamariateresa': 5, 'elkammmmmmmmoide': 5}
hMin = {'x': 1, 'bi': 3, 'ugo': 4, 'albo': 4, 'lollo': 3, 'chiara': 4, 'selenia': 4, 'pancotto': 4, 'giacomino': 4, 'eugenietto': 4, 'ermenegildo': 2, 'francescopio': 4, 'gianmichelino': 4, 'francescomario': 4, 'annamariateresa': 4, 'elkammmmmmmmoide': 4}


disponibilita = {
'x' : {'1h': 0, '2h': 3, '3h': 1, '4h': 0, '5h': 3, '6h': 2, '7h': 1, '8h': 0, '9h': 2, '10h': 2, '11h': 0, '12h': 2, '13h': 0, '14h': 0, '15h': 0, '16h': 2, '17h': 1, '18h': 1, '19h': 2, '20h': 2, '21h': 1, '22h': 3, '23h': 0, '24h': 0, '25h': 0, '26h': 0, '27h': 1, '28h': 2, '29h': 3, '30h': 1, '31h': 2, '32h': 0, '33h': 3, '34h': 0, '35h': 3, '36h': 0, '37h': 3, '38h': 3, '39h': 3, '40h': 2, '41h': 1, '42h': 1, '43h': 3, '44h': 2, '45h': 1, '46h': 2, '47h': 0, '48h': 3, '49h': 2, '50h': 0, '51h': 3, '52h': 2, '53h': 3, '54h': 0, '55h': 0, '56h': 2, '57h': 3, '58h': 0, '59h': 1, '60h': 0, '61h': 2, '62h': 3, '63h': 0, '64h': 1, '65h': 0, '66h': 3, '67h': 3, '68h': 2, '69h': 0, '70h': 1, '71h': 3, '72h': 1, '73h': 2, '74h': 0 },
'bi' : {'1h': 2, '2h': 2, '3h': 3, '4h': 0, '5h': 3, '6h': 3, '7h': 1, '8h': 3, '9h': 2, '10h': 3, '11h': 2, '12h': 2, '13h': 1, '14h': 3, '15h': 1, '16h': 2, '17h': 1, '18h': 1, '19h': 2, '20h': 3, '21h': 3, '22h': 3, '23h': 2, '24h': 3, '25h': 0, '26h': 3, '27h': 1, '28h': 0, '29h': 3, '30h': 3, '31h': 2, '32h': 3, '33h': 1, '34h': 3, '35h': 2, '36h': 0, '37h': 3, '38h': 3, '39h': 0, '40h': 2, '41h': 0, '42h': 2, '43h': 2, '44h': 2, '45h': 1, '46h': 2, '47h': 2, '48h': 2, '49h': 1, '50h': 1, '51h': 0, '52h': 1, '53h': 3, '54h': 3, '55h': 3, '56h': 1, '57h': 3, '58h': 0, '59h': 3, '60h': 2, '61h': 0, '62h': 0, '63h': 1, '64h': 0, '65h': 1, '66h': 2, '67h': 3, '68h': 2, '69h': 3, '70h': 3, '71h': 0, '72h': 0, '73h': 3, '74h': 1 },
'ugo' : {'1h': 0, '2h': 1, '3h': 1, '4h': 2, '5h': 2, '6h': 0, '7h': 3, '8h': 2, '9h': 2, '10h': 2, '11h': 0, '12h': 0, '13h': 1, '14h': 0, '15h': 0, '16h': 1, '17h': 1, '18h': 3, '19h': 1, '20h': 0, '21h': 1, '22h': 0, '23h': 0, '24h': 3, '25h': 0, '26h': 1, '27h': 0, '28h': 0, '29h': 0, '30h': 1, '31h': 2, '32h': 2, '33h': 1, '34h': 1, '35h': 0, '36h': 2, '37h': 1, '38h': 2, '39h': 2, '40h': 2, '41h': 2, '42h': 1, '43h': 2, '44h': 0, '45h': 3, '46h': 1, '47h': 0, '48h': 3, '49h': 3, '50h': 0, '51h': 1, '52h': 3, '53h': 3, '54h': 2, '55h': 2, '56h': 3, '57h': 0, '58h': 0, '59h': 2, '60h': 2, '61h': 3, '62h': 1, '63h': 0, '64h': 0, '65h': 1, '66h': 3, '67h': 3, '68h': 0, '69h': 0, '70h': 2, '71h': 3, '72h': 3, '73h': 3, '74h': 0 },
'albo' : {'1h': 3, '2h': 3, '3h': 0, '4h': 1, '5h': 0, '6h': 1, '7h': 3, '8h': 2, '9h': 3, '10h': 1, '11h': 0, '12h': 0, '13h': 2, '14h': 3, '15h': 2, '16h': 0, '17h': 0, '18h': 0, '19h': 3, '20h': 2, '21h': 0, '22h': 3, '23h': 0, '24h': 1, '25h': 2, '26h': 2, '27h': 2, '28h': 0, '29h': 2, '30h': 3, '31h': 1, '32h': 2, '33h': 3, '34h': 2, '35h': 3, '36h': 2, '37h': 0, '38h': 1, '39h': 2, '40h': 2, '41h': 2, '42h': 3, '43h': 1, '44h': 1, '45h': 2, '46h': 0, '47h': 2, '48h': 2, '49h': 3, '50h': 0, '51h': 3, '52h': 1, '53h': 2, '54h': 0, '55h': 2, '56h': 3, '57h': 2, '58h': 0, '59h': 0, '60h': 0, '61h': 1, '62h': 0, '63h': 1, '64h': 2, '65h': 0, '66h': 0, '67h': 3, '68h': 1, '69h': 0, '70h': 0, '71h': 1, '72h': 1, '73h': 1, '74h': 1 },
'lollo' : {'1h': 0, '2h': 1, '3h': 0, '4h': 0, '5h': 3, '6h': 1, '7h': 0, '8h': 0, '9h': 2, '10h': 1, '11h': 3, '12h': 0, '13h': 1, '14h': 3, '15h': 1, '16h': 0, '17h': 3, '18h': 0, '19h': 1, '20h': 3, '21h': 0, '22h': 2, '23h': 0, '24h': 3, '25h': 0, '26h': 2, '27h': 3, '28h': 1, '29h': 1, '30h': 0, '31h': 0, '32h': 2, '33h': 3, '34h': 0, '35h': 3, '36h': 1, '37h': 0, '38h': 1, '39h': 0, '40h': 2, '41h': 0, '42h': 0, '43h': 2, '44h': 1, '45h': 3, '46h': 1, '47h': 1, '48h': 0, '49h': 0, '50h': 3, '51h': 2, '52h': 1, '53h': 0, '54h': 3, '55h': 2, '56h': 0, '57h': 3, '58h': 0, '59h': 2, '60h': 1, '61h': 3, '62h': 2, '63h': 2, '64h': 0, '65h': 2, '66h': 1, '67h': 2, '68h': 0, '69h': 0, '70h': 3, '71h': 2, '72h': 1, '73h': 1, '74h': 3 },
'chiara' : {'1h': 1, '2h': 2, '3h': 3, '4h': 3, '5h': 3, '6h': 1, '7h': 2, '8h': 1, '9h': 0, '10h': 0, '11h': 0, '12h': 3, '13h': 0, '14h': 1, '15h': 2, '16h': 1, '17h': 2, '18h': 2, '19h': 1, '20h': 1, '21h': 1, '22h': 1, '23h': 0, '24h': 0, '25h': 1, '26h': 0, '27h': 2, '28h': 1, '29h': 1, '30h': 2, '31h': 3, '32h': 0, '33h': 3, '34h': 2, '35h': 2, '36h': 2, '37h': 0, '38h': 3, '39h': 0, '40h': 2, '41h': 3, '42h': 2, '43h': 1, '44h': 1, '45h': 3, '46h': 1, '47h': 0, '48h': 3, '49h': 0, '50h': 0, '51h': 3, '52h': 2, '53h': 1, '54h': 2, '55h': 3, '56h': 2, '57h': 1, '58h': 2, '59h': 2, '60h': 2, '61h': 2, '62h': 2, '63h': 3, '64h': 0, '65h': 2, '66h': 3, '67h': 3, '68h': 2, '69h': 0, '70h': 1, '71h': 1, '72h': 1, '73h': 2, '74h': 1 },
'selenia' : {'1h': 2, '2h': 2, '3h': 0, '4h': 3, '5h': 2, '6h': 0, '7h': 0, '8h': 1, '9h': 3, '10h': 3, '11h': 0, '12h': 0, '13h': 1, '14h': 3, '15h': 2, '16h': 3, '17h': 0, '18h': 3, '19h': 1, '20h': 2, '21h': 0, '22h': 0, '23h': 2, '24h': 0, '25h': 2, '26h': 3, '27h': 2, '28h': 0, '29h': 0, '30h': 3, '31h': 3, '32h': 3, '33h': 1, '34h': 3, '35h': 1, '36h': 3, '37h': 0, '38h': 2, '39h': 0, '40h': 1, '41h': 2, '42h': 3, '43h': 2, '44h': 0, '45h': 1, '46h': 2, '47h': 0, '48h': 1, '49h': 1, '50h': 2, '51h': 1, '52h': 0, '53h': 0, '54h': 1, '55h': 3, '56h': 1, '57h': 2, '58h': 0, '59h': 0, '60h': 0, '61h': 2, '62h': 0, '63h': 0, '64h': 0, '65h': 3, '66h': 3, '67h': 2, '68h': 3, '69h': 2, '70h': 0, '71h': 3, '72h': 0, '73h': 2, '74h': 2 },
'pancotto' : {'1h': 3, '2h': 3, '3h': 1, '4h': 1, '5h': 1, '6h': 0, '7h': 0, '8h': 3, '9h': 0, '10h': 1, '11h': 1, '12h': 1, '13h': 2, '14h': 0, '15h': 1, '16h': 3, '17h': 1, '18h': 2, '19h': 3, '20h': 1, '21h': 0, '22h': 2, '23h': 2, '24h': 3, '25h': 0, '26h': 3, '27h': 1, '28h': 3, '29h': 2, '30h': 2, '31h': 3, '32h': 2, '33h': 2, '34h': 2, '35h': 3, '36h': 2, '37h': 2, '38h': 2, '39h': 0, '40h': 0, '41h': 1, '42h': 3, '43h': 3, '44h': 2, '45h': 3, '46h': 1, '47h': 0, '48h': 3, '49h': 3, '50h': 0, '51h': 1, '52h': 0, '53h': 2, '54h': 2, '55h': 2, '56h': 0, '57h': 3, '58h': 0, '59h': 1, '60h': 1, '61h': 0, '62h': 3, '63h': 0, '64h': 1, '65h': 1, '66h': 0, '67h': 3, '68h': 2, '69h': 0, '70h': 0, '71h': 3, '72h': 0, '73h': 3, '74h': 0 },
'giacomino' : {'1h': 3, '2h': 0, '3h': 2, '4h': 2, '5h': 3, '6h': 0, '7h': 2, '8h': 3, '9h': 3, '10h': 0, '11h': 0, '12h': 0, '13h': 0, '14h': 0, '15h': 2, '16h': 2, '17h': 0, '18h': 0, '19h': 3, '20h': 0, '21h': 0, '22h': 1, '23h': 2, '24h': 2, '25h': 2, '26h': 0, '27h': 1, '28h': 3, '29h': 1, '30h': 2, '31h': 1, '32h': 0, '33h': 1, '34h': 2, '35h': 0, '36h': 2, '37h': 2, '38h': 0, '39h': 0, '40h': 0, '41h': 1, '42h': 2, '43h': 0, '44h': 1, '45h': 1, '46h': 0, '47h': 0, '48h': 2, '49h': 0, '50h': 2, '51h': 1, '52h': 1, '53h': 0, '54h': 0, '55h': 3, '56h': 3, '57h': 0, '58h': 2, '59h': 0, '60h': 2, '61h': 3, '62h': 1, '63h': 3, '64h': 2, '65h': 0, '66h': 1, '67h': 1, '68h': 3, '69h': 0, '70h': 1, '71h': 1, '72h': 0, '73h': 0, '74h': 1 },
'eugenietto' : {'1h': 1, '2h': 1, '3h': 2, '4h': 3, '5h': 0, '6h': 2, '7h': 1, '8h': 0, '9h': 2, '10h': 0, '11h': 2, '12h': 3, '13h': 3, '14h': 0, '15h': 0, '16h': 0, '17h': 2, '18h': 2, '19h': 2, '20h': 2, '21h': 1, '22h': 1, '23h': 1, '24h': 2, '25h': 1, '26h': 3, '27h': 0, '28h': 1, '29h': 2, '30h': 1, '31h': 2, '32h': 0, '33h': 1, '34h': 2, '35h': 2, '36h': 2, '37h': 1, '38h': 1, '39h': 3, '40h': 1, '41h': 3, '42h': 2, '43h': 0, '44h': 2, '45h': 1, '46h': 0, '47h': 1, '48h': 3, '49h': 3, '50h': 0, '51h': 2, '52h': 3, '53h': 1, '54h': 1, '55h': 2, '56h': 2, '57h': 2, '58h': 1, '59h': 3, '60h': 1, '61h': 2, '62h': 0, '63h': 0, '64h': 0, '65h': 1, '66h': 1, '67h': 2, '68h': 0, '69h': 2, '70h': 0, '71h': 3, '72h': 1, '73h': 0, '74h': 2 },
'ermenegildo' : {'1h': 1, '2h': 2, '3h': 3, '4h': 0, '5h': 0, '6h': 0, '7h': 3, '8h': 3, '9h': 0, '10h': 3, '11h': 2, '12h': 0, '13h': 3, '14h': 3, '15h': 3, '16h': 1, '17h': 0, '18h': 2, '19h': 1, '20h': 1, '21h': 0, '22h': 1, '23h': 0, '24h': 2, '25h': 2, '26h': 0, '27h': 2, '28h': 3, '29h': 1, '30h': 1, '31h': 2, '32h': 2, '33h': 2, '34h': 0, '35h': 1, '36h': 0, '37h': 0, '38h': 3, '39h': 2, '40h': 2, '41h': 0, '42h': 3, '43h': 3, '44h': 3, '45h': 0, '46h': 1, '47h': 2, '48h': 1, '49h': 3, '50h': 0, '51h': 0, '52h': 3, '53h': 1, '54h': 0, '55h': 1, '56h': 2, '57h': 2, '58h': 2, '59h': 2, '60h': 2, '61h': 3, '62h': 3, '63h': 3, '64h': 1, '65h': 2, '66h': 3, '67h': 0, '68h': 0, '69h': 0, '70h': 3, '71h': 1, '72h': 2, '73h': 3, '74h': 3 },
'francescopio' : {'1h': 1, '2h': 2, '3h': 1, '4h': 0, '5h': 0, '6h': 3, '7h': 1, '8h': 3, '9h': 2, '10h': 3, '11h': 0, '12h': 2, '13h': 1, '14h': 1, '15h': 2, '16h': 2, '17h': 2, '18h': 1, '19h': 1, '20h': 0, '21h': 2, '22h': 1, '23h': 1, '24h': 0, '25h': 1, '26h': 3, '27h': 3, '28h': 1, '29h': 2, '30h': 1, '31h': 0, '32h': 0, '33h': 0, '34h': 2, '35h': 2, '36h': 0, '37h': 0, '38h': 3, '39h': 3, '40h': 2, '41h': 0, '42h': 3, '43h': 2, '44h': 1, '45h': 1, '46h': 3, '47h': 3, '48h': 2, '49h': 0, '50h': 0, '51h': 2, '52h': 3, '53h': 3, '54h': 1, '55h': 2, '56h': 0, '57h': 1, '58h': 2, '59h': 3, '60h': 1, '61h': 2, '62h': 0, '63h': 2, '64h': 2, '65h': 0, '66h': 0, '67h': 3, '68h': 3, '69h': 2, '70h': 3, '71h': 2, '72h': 0, '73h': 3, '74h': 3 },
'gianmichelino' : {'1h': 2, '2h': 3, '3h': 1, '4h': 1, '5h': 2, '6h': 0, '7h': 3, '8h': 1, '9h': 1, '10h': 2, '11h': 1, '12h': 3, '13h': 2, '14h': 1, '15h': 2, '16h': 0, '17h': 2, '18h': 0, '19h': 2, '20h': 0, '21h': 3, '22h': 0, '23h': 2, '24h': 2, '25h': 2, '26h': 3, '27h': 3, '28h': 1, '29h': 0, '30h': 3, '31h': 3, '32h': 1, '33h': 2, '34h': 3, '35h': 3, '36h': 0, '37h': 2, '38h': 1, '39h': 2, '40h': 1, '41h': 1, '42h': 0, '43h': 3, '44h': 0, '45h': 0, '46h': 1, '47h': 3, '48h': 2, '49h': 1, '50h': 0, '51h': 2, '52h': 3, '53h': 0, '54h': 2, '55h': 1, '56h': 0, '57h': 3, '58h': 3, '59h': 0, '60h': 0, '61h': 3, '62h': 3, '63h': 3, '64h': 2, '65h': 0, '66h': 0, '67h': 3, '68h': 0, '69h': 0, '70h': 3, '71h': 2, '72h': 3, '73h': 3, '74h': 1 },
'francescomario' : {'1h': 1, '2h': 3, '3h': 1, '4h': 3, '5h': 3, '6h': 1, '7h': 0, '8h': 3, '9h': 3, '10h': 3, '11h': 1, '12h': 0, '13h': 0, '14h': 3, '15h': 3, '16h': 3, '17h': 0, '18h': 3, '19h': 0, '20h': 3, '21h': 0, '22h': 3, '23h': 3, '24h': 0, '25h': 3, '26h': 3, '27h': 0, '28h': 0, '29h': 1, '30h': 3, '31h': 0, '32h': 1, '33h': 2, '34h': 3, '35h': 1, '36h': 2, '37h': 1, '38h': 2, '39h': 3, '40h': 3, '41h': 0, '42h': 0, '43h': 2, '44h': 2, '45h': 2, '46h': 3, '47h': 0, '48h': 1, '49h': 2, '50h': 0, '51h': 1, '52h': 2, '53h': 1, '54h': 3, '55h': 1, '56h': 3, '57h': 1, '58h': 3, '59h': 2, '60h': 0, '61h': 3, '62h': 2, '63h': 1, '64h': 2, '65h': 2, '66h': 0, '67h': 0, '68h': 2, '69h': 2, '70h': 1, '71h': 2, '72h': 1, '73h': 2, '74h': 2 },
'annamariateresa' : {'1h': 3, '2h': 0, '3h': 3, '4h': 0, '5h': 0, '6h': 3, '7h': 0, '8h': 3, '9h': 1, '10h': 2, '11h': 1, '12h': 1, '13h': 2, '14h': 3, '15h': 2, '16h': 0, '17h': 3, '18h': 2, '19h': 2, '20h': 3, '21h': 1, '22h': 2, '23h': 2, '24h': 1, '25h': 2, '26h': 3, '27h': 2, '28h': 1, '29h': 0, '30h': 1, '31h': 3, '32h': 0, '33h': 0, '34h': 1, '35h': 0, '36h': 1, '37h': 1, '38h': 1, '39h': 0, '40h': 3, '41h': 1, '42h': 0, '43h': 3, '44h': 2, '45h': 1, '46h': 2, '47h': 3, '48h': 1, '49h': 2, '50h': 2, '51h': 3, '52h': 2, '53h': 0, '54h': 3, '55h': 1, '56h': 1, '57h': 2, '58h': 0, '59h': 1, '60h': 3, '61h': 1, '62h': 1, '63h': 2, '64h': 3, '65h': 3, '66h': 1, '67h': 2, '68h': 1, '69h': 1, '70h': 3, '71h': 1, '72h': 2, '73h': 0, '74h': 0 },
'elkammmmmmmmoide' : {'1h': 3, '2h': 1, '3h': 2, '4h': 3, '5h': 3, '6h': 3, '7h': 0, '8h': 2, '9h': 1, '10h': 1, '11h': 1, '12h': 3, '13h': 1, '14h': 2, '15h': 2, '16h': 3, '17h': 1, '18h': 0, '19h': 2, '20h': 1, '21h': 3, '22h': 0, '23h': 2, '24h': 3, '25h': 0, '26h': 3, '27h': 0, '28h': 2, '29h': 3, '30h': 1, '31h': 0, '32h': 3, '33h': 1, '34h': 0, '35h': 1, '36h': 0, '37h': 2, '38h': 3, '39h': 2, '40h': 0, '41h': 3, '42h': 0, '43h': 1, '44h': 0, '45h': 1, '46h': 3, '47h': 1, '48h': 0, '49h': 0, '50h': 2, '51h': 2, '52h': 3, '53h': 0, '54h': 3, '55h': 3, '56h': 1, '57h': 1, '58h': 0, '59h': 0, '60h': 0, '61h': 1, '62h': 1, '63h': 0, '64h': 3, '65h': 1, '66h': 1, '67h': 0, '68h': 0, '69h': 1, '70h': 0, '71h': 0, '72h': 1, '73h': 0, '74h': 0 }}

prob = pulp.LpProblem("problema part time", pulp.LpMaximize)

assegnamento = [(p, h) for p in persone for h in ore]

# definizione variabile
x = pulp.LpVariable.dicts("assegnamento", (persone, ore), lowBound = 0, cat ='Binary')

prob += sum([x[p][h] * disponibilita[p][h] for (p, h) in assegnamento]), "Funzione_Obiettivo"

for p in persone:prob += sum([x[p][h] for h in ore]) <= hMax[p], "Ore_Massime_%s" % p

for p in persone:prob += sum([x[p][h] for h in ore]) >= hMin[p], "Ore_Minime_%s" % p

for h in ore:prob += sum([x[p][h] for p in persone]) == 1, "Ore_da_fare_%s" % h

#for h in ['5h', '6h', '7h', '8h']:prob += sum([x[p][h] for p in persone]) == 3, "Ore_da_fare_con_agraria%s" % h

for (p, h) in assegnamento:
    if disponibilita[p][h] == 0:
        prob += x[p][h] == 0

# for p in persone:prob += x[p]['21h'] == x[p]['22h']

# for p in persone:prob += x[p]['3h'] + x[p]['21h'] <= 1

# for p in persone:prob += x[p]['4h'] + x[p]['21h'] <= 1
# for p in persone:prob += x[p]['4h'] + x[p]['22h'] <= 1

# for p in persone:prob += x[p]['5h'] + x[p]['22h'] <= 1

var = prob.solve()

print(var)

a = ''
for p in persone:
    print('ore affidate ad ' + p + ':')
    for h in ore:
        if x[p][h].value() != 0:
            a = a + h + ' '
    print(a)
    a = ''
'''
for (p, h) in assegnamento:
    if x[p][h].value() != 0:
        print('%s --> %s' % (x[p][h], x[p][h].value()))'''